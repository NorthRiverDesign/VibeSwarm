@* Conversation messages container component - shown after job completes *@

<div class="card">
	<div class="card-header bg-body-secondary d-flex justify-content-between align-items-center">
		<h5 class="mb-0 fw-semibold"><i class="bi bi-chat-dots me-2 opacity-75"></i>Conversation</h5>
		@if (Messages.Any())
		{
			<span class="badge bg-secondary">@Messages.Count</span>
		}
	</div>
	<div class="card-body p-2 p-sm-3">
		@if (!Messages.Any())
		{
			<div class="empty-state text-center py-4">
				<i class="bi bi-chat-left-text opacity-50 d-block mb-2" style="font-size: 2rem;"></i>
				@if (IsJobRunning)
				{
					<span class="text-body-secondary">Conversation will appear here when the agent completes.</span>
				}
				else if (Status == JobStatus.New || Status == JobStatus.Pending)
				{
					<span class="text-body-secondary">Conversation will appear after the job runs.</span>
				}
				else
				{
					<span class="text-body-secondary">No conversation recorded for this job.</span>
				}
			</div>
		}
		else
		{
			<div class="chat-messages-container">
				@foreach (var message in Messages)
				{
					<ChatMessage Role="@message.Role" Content="@message.Content" ToolName="@message.ToolName"
						ToolInput="@message.ToolInput" ToolOutput="@message.ToolOutput" Timestamp="@message.CreatedAt" />
				}
			</div>
		}
	</div>
</div>

@code {
	[Parameter]
	public List<JobMessage> Messages { get; set; } = new();

	[Parameter]
	public JobStatus Status { get; set; }

	[Parameter]
	public bool IsActive { get; set; }

	[Parameter]
	public string? CurrentActivity { get; set; }

	[Parameter]
	public DateTime? LastActivityAt { get; set; }

	private bool IsJobRunning => Status == JobStatus.Started || Status == JobStatus.Processing;
}