@* Reusable provider card component for dashboard view *@
@using VibeSwarm.Shared.Data

<div class="card h-100 border-start border-info border-3 @(IsEnabled ? "" : "opacity-50")">
	<div class="card-body">
		<div class="d-flex justify-content-between align-items-start mb-2">
			<h6 class="card-title fw-semibold mb-0">@Name</h6>
			<div class="d-flex align-items-center gap-2">
				@if (UsageSummary?.IsLimitReached == true)
				{
					<span class="badge bg-danger" title="Usage limit reached">Limit Reached</span>
				}
				<StatusBadge Status="@(IsEnabled ? "Active" : "Off")" ShowSpinner="false" />
			</div>
		</div>
		<div class="d-flex flex-wrap gap-2 small mt-1">
			<span class="badge bg-primary-subtle text-primary-emphasis">
				<i class="bi bi-@GetProviderTypeIcon(ProviderType) me-1"></i>@ProviderType
			</span>
			<span class="badge bg-info-subtle text-info-emphasis">
				<i class="bi bi-@GetConnectionModeIcon(ConnectionMode) me-1"></i>@ConnectionMode
			</span>
			@if (!string.IsNullOrEmpty(CliVersion))
			{
				<span class="badge bg-secondary-subtle text-secondary-emphasis">
					<i class="bi bi-tag me-1"></i>@CliVersion
				</span>
			}
		</div>
		@if (UsageSummary != null && UsageSummary.EffectiveMaxUsage > 0)
		{
			<div class="mt-2 pt-2 border-top">
				<UsageMeter UsageSummary="UsageSummary" Compact="true" ShowResetTime="false" />
			</div>
		}
	</div>
</div>

@code {
	[Parameter]
	public string Name { get; set; } = string.Empty;

	[Parameter]
	public string ProviderType { get; set; } = string.Empty;

	[Parameter]
	public string ConnectionMode { get; set; } = string.Empty;

	[Parameter]
	public bool IsEnabled { get; set; }

	[Parameter]
	public string? CliVersion { get; set; }

	[Parameter]
	public ProviderUsageSummary? UsageSummary { get; set; }

	private static string GetProviderTypeIcon(string type) => type switch
	{
		"OpenCode" => "code-slash",
		"Claude" => "robot",
		"Copilot" => "github",
		_ => "cpu"
	};

	private static string GetConnectionModeIcon(string mode) => mode switch
	{
		"CLI" => "terminal",
		"REST" => "globe",
		"SDK" => "box",
		_ => "plug"
	};
}